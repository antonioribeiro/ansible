---
# This playbook contains common plays that will be run on all nodes.

- name: apache2, php5
  action: apt pkg={{ item }} state=latest
  with_items:
     - apache2
     - php5
     - php5-cli
     - php-apc
     - libapache2-mod-php5
     - php-pear 
     - php-xml-parser 
     - php5-cgi 
     - php5-common
     - php5-curl
     - php5-dev
     - php5-geoip
     - php5-ldap
     - php5-mcrypt
     - php5-pgsql
     - php5-xmlrpc
     - php5-imagick
#  tags: apache2


##
# Apache2 setup.
#

#- name: enable modules
#  command: a2enmod {{item}}
#  with_items:
#     - rewrite
#     - headers
#     - vhost_alias
#  tags: apache2

#- name: Apache | Configuration file for our site
#  action: template src=etc-apache2-sites-available-devserver.j2 dest=/etc/apache2/sites-available/devserver
#  tags: common

#- name: Apache | Disable the default site
#  action: command a2dissite default
#  tags: common

#- name: Apache | Enable our new site
#  action: command a2ensite devserver
#  tags: common



##
# PHP Setup.
#
#- name: PHP | Configuration file, php.ini
#  action: template src=etc-php5-apache2-php-ini.j2 dest=/etc/php5/apache2/php.ini
#  tags: apache2

#- name: APC | Cache configuration file, apc.ini
#  action: template src=etc-php5-conf-d-apc-ini.j2 dest=/etc/php5/conf.d/apc.ini
#  tags: apache2



##
# Restart services
#

#- name: Restart Apache
#  action: service name=apache2 state=restarted
#  tags: common
